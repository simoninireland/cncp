
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Generating cumulative generating functions &#8212; Complex networks, complex processes: A network science miscellany</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="copyright" title="Copyright" href="copyright.html" />
    <link rel="next" title="Epidemic simulation" href="simulation.html" />
    <link rel="prev" title="High-degree numerical differentiation of generating functions" href="cauchy.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Complex networks, complex processes: A network science miscellany</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="index.html">
   Complex networks, complex processes: A network science miscellany
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="cauchy.html">
   High-degree numerical differentiation of generating functions
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Generating cumulative generating functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="simulation.html">
   Epidemic simulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="synchronous.html">
   <span id="chap_epidemic_synchronous">
   </span>
   Synchronous simulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="gillespie.html">
   Gillespie simulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zbibliography.html">
   References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="about.html">
   About the author
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="copyright.html">
   Copyright
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/generating-cdfs.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/simoninireland/cncp/master?urlpath=tree/generating-cdfs.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#generating-cdfs">
   Generating CDFs
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quick-sanity-check">
   Quick sanity check
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#larger-sanity-check">
   Larger sanity check
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Generating cumulative generating functions</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#generating-cdfs">
   Generating CDFs
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quick-sanity-check">
   Quick sanity check
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#larger-sanity-check">
   Larger sanity check
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="generating-cumulative-generating-functions">
<h1>Generating cumulative generating functions<a class="headerlink" href="#generating-cumulative-generating-functions" title="Permalink to this headline">¶</a></h1>
<p>Generating function string together a sequence of values combined with a formal parameter <span class="math notranslate nohighlight">\(x\)</span> raised to the appropriate power of <span class="math notranslate nohighlight">\(k\)</span>. In the case of the probbability generating functions we’re most interested in, these values are coefficients <span class="math notranslate nohighlight">\(\{ p_k \}_{k = 0}^\infty\)</span>. It is these coefficients that are the interesting part of the construction.</p>
<p>A probability generating function holds all the information about the distribution and can be manipulated in various ways. To extract the mean degree of nodes, for example, we evaluate</p>
<div class="math notranslate nohighlight">
\[
\langle k \rangle = \sum_k k \, p_k = G_0'(1)
\]</div>
<p>where <span class="math notranslate nohighlight">\(G_0'(x)\)</span> is the first derivative of <span class="math notranslate nohighlight">\(G_0(x)\)</span> which is then executed at 1 to include all the terms. Similar operations can be performed to extract other moments and statistical features. The important point is that these operations are defined purely in terms of the generating function and so work for <em>any</em> such function, not simply one defined by explicit terms. A network with a particular degree distribution will often have a generating function that is not “spelled out” like this, but the operations still work.</p>
<p>(Note that the generating function is a purely formal mathematical device for representing the probability distribution, and the “derivative” is similarly a formal device for manipulating the terms in the formal series: it has nothing whatever to do with rates of change of anything.)</p>
<p>A more complicated feature of a distribution is the cumulative density function or CDF, often written <span class="math notranslate nohighlight">\(P(k \le v)\)</span>, capturing the probability of <span class="math notranslate nohighlight">\(k\)</span> being less than or equal to some value <span class="math notranslate nohighlight">\(v\)</span>. This is usually defined by integration of the distribution:</p>
<div class="math notranslate nohighlight">
\[
P(k \le v) = \sum_{k = 0}^{v} p_k
\]</div>
<p>where we use a discrete sum since degrees are always whole numbers. Since we have all the information we need encapsulated in the generating function, how can we generate the CDF directly from the probability generating function?</p>
<div class="section" id="generating-cdfs">
<h2>Generating CDFs<a class="headerlink" href="#generating-cdfs" title="Permalink to this headline">¶</a></h2>
<p>Let us re-phrase the problem slightly. Instead of the traditional CDF, what if we are instead interested in the probability of a node having a degree <em>greater or equal to</em> some threshold? – <span class="math notranslate nohighlight">\(P(k \geq v)\)</span>. In our case this would then be the probabbility that a node chosen at random had a degree greater than or equal to some value, whcih would be used for example to explore the effects of “hub” nodes with lots of neighbbours. Intuitively is seems that this value is generated by summing the terms of <span class="math notranslate nohighlight">\(p_k\)</span> greater than or equal to <span class="math notranslate nohighlight">\(v\)</span>, which are generated by the terms of <span class="math notranslate nohighlight">\(G_0(x)\)</span> in powers of <span class="math notranslate nohighlight">\(x\)</span> greater than or equal to <span class="math notranslate nohighlight">\(v\)</span>, discounting all terms in powers of <span class="math notranslate nohighlight">\(x\)</span> less than <span class="math notranslate nohighlight">\(v\)</span>.</p>
<p>Having re-phrased the question in this way, it turns out that the answer is known for the general case of generating functions <a class="reference external" href="#generatingfunctionology">[Wil94]</a>.</p>
<p><span class="math notranslate nohighlight">\(G_0(x)\)</span> is a generating function built from an “ordinary” power
series, a sequence of coefficients of the form <span class="math notranslate nohighlight">\(\{ p_k \}_{k =
0}^\infty\)</span>. What function generates the sequence <span class="math notranslate nohighlight">\(\{ p_{k + 1} \}_{k =
0}^\infty\)</span>? – in other words, dropping the first term?</p>
<div class="math notranslate nohighlight">
\[
\sum_{k \geq 0} p_{k + 1} \, x^k = \frac{1}{x} \sum_{m \geq 1} p_m \, x^m
\]</div>
<p>which is</p>
<div class="math notranslate nohighlight">
\[
G_{0, 1} (x) = \frac{G_0(x) - p_0}{x}
\]</div>
<p>Shifting the subscript by one changes the series by a factor
determined by the first coefficient. If we want to generate the series
from the <span class="math notranslate nohighlight">\(h\)</span>’th term then we use:</p>
<div class="math notranslate nohighlight">
\[
G_{0, h}(x) = \frac{G_0(x) - p_0 - \cdots - p_{h - 1} \, x^{h - 1}}{x^h}
\]</div>
<p>So computing <span class="math notranslate nohighlight">\(G_{0, h}(1)\)</span> gives us the probability of a node having a
degree greater than or equal to <span class="math notranslate nohighlight">\(h\)</span>.</p>
<p>We still need the values of <span class="math notranslate nohighlight">\(p_k\)</span> for <span class="math notranslate nohighlight">\(k \lt h\)</span>. We can obtain these
in two ways. Firstly, they may be explicitly measurable from an
empirical or generated network. If this is the case then by definition
we have all the <span class="math notranslate nohighlight">\(p_k\)</span>, and so can compute <span class="math notranslate nohighlight">\(P(k \geq h)\)</span> directly as
<span class="math notranslate nohighlight">\(P(k \geq h) = \sum_{k \geq h} p_k\)</span>.</p>
<p>Secondly, we can obtain <span class="math notranslate nohighlight">\(p_k\)</span> from the <span class="math notranslate nohighlight">\(k\)</span>’th derivative of <span class="math notranslate nohighlight">\(G_0\)</span>:</p>
<div class="math notranslate nohighlight">
\[
p_k = \frac{1}{k!} \, \left( \frac{d}{dx} \right)^k \, G_0(x) \; \Big|_{x = 0}
\]</div>
<p>which works for <em>any</em> probbability generating function.</p>
</div>
<div class="section" id="quick-sanity-check">
<h2>Quick sanity check<a class="headerlink" href="#quick-sanity-check" title="Permalink to this headline">¶</a></h2>
<p>Suppose we have a network with <span class="math notranslate nohighlight">\(N = 5\)</span> and the following degree
distribution:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p><span class="math notranslate nohighlight">\(k\)</span></p></th>
<th class="text-align:left head"><p><span class="math notranslate nohighlight">\(p_k\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>0</p></td>
<td class="text-align:left"><p>0</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>1</p></td>
<td class="text-align:left"><p>2/5</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>2</p></td>
<td class="text-align:left"><p>1/5</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>3</p></td>
<td class="text-align:left"><p>2/5</p></td>
</tr>
</tbody>
</table>
<p>What is <span class="math notranslate nohighlight">\(P(k \ge 2)\)</span>? Given the above we can simply read the answer
off as <span class="math notranslate nohighlight">\(p_2 + p_3 = 1/5 + 2/5 = 3/5\)</span>. The degree sequence is generated
by:</p>
<div class="math notranslate nohighlight">
\[
G_0(x) = 0 + 2/5 x + 1/5 x^2 + 2/5 x^3
\]</div>
<p>Computing the CDF:</p>
<p>\begin{align*}
G_{0, 2}(1) &amp;= \frac{G_0(1) - p_0 - p_1 , x }{x^2} \
&amp;= \frac{1 - 0 - 2/5}{1} \
&amp;= 3/5
\end{align*}</p>
</div>
<div class="section" id="larger-sanity-check">
<h2>Larger sanity check<a class="headerlink" href="#larger-sanity-check" title="Permalink to this headline">¶</a></h2>
<p>For a better sanity check, we compare the empirical calculation of <span class="math notranslate nohighlight">\(P(k \geq v)\)</span> for a network against the value generated by the CDF generating function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">cmath</span>
<span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">networkx</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">mpmath</span>
<span class="kn">import</span> <span class="nn">epydemic</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;png&#39;
<span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">300</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn&#39;</span><span class="p">)</span>
<span class="n">seaborn</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">&#39;notebook&#39;</span><span class="p">,</span> <span class="n">font_scale</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We will start with an ER network of <span class="math notranslate nohighlight">\(N = 10^4\)</span> nodes and <span class="math notranslate nohighlight">\(\langle k \rangle = 8\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e4</span><span class="p">)</span>
<span class="n">kmean</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
<p>We create a network with this topology.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">networkx</span><span class="o">.</span><span class="n">fast_gnp_random_graph</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">kmean</span> <span class="o">/</span> <span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Given a network, we can compute the number of nodes of each degree simply by counting.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">nk_g</span><span class="p">(</span><span class="n">g</span><span class="p">):</span>
    <span class="n">degrees</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">degree</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">degrees</span><span class="p">:</span>
            <span class="n">degrees</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">degrees</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="k">def</span> <span class="nf">nk</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">degrees</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">degrees</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        
    <span class="k">return</span> <span class="n">nk</span>
</pre></div>
</div>
</div>
</div>
<p>From this we can define a function that gives the empirical value of <span class="math notranslate nohighlight">\(p_k\)</span> for any network.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pk_g</span><span class="p">(</span><span class="n">g</span><span class="p">):</span>
    <span class="n">nk</span> <span class="o">=</span> <span class="n">nk_g</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">pk</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">nk</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">/</span> <span class="n">g</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">pk</span>
</pre></div>
</div>
</div>
</div>
<p>For an ER network, the probability of randomly choosing a node with a given degree is</p>
<div class="math notranslate nohighlight">
\[
p_k = \frac{\langle k \rangle^k e^{-\langle k \rangle}}{k!}
\]</div>
<p>which we can code directly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pk_ER</span><span class="p">(</span><span class="n">kmean</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Return a function that computes p_k for a given k on an ER network.&#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">pk</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">kmean</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">kmean</span><span class="p">))</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pk</span>
</pre></div>
</div>
</div>
</div>
<p>This function, when called with the parameters of the ER network, returns a function for <span class="math notranslate nohighlight">\(p_k\)</span>.</p>
<p>We can check these functions by plotting the theoretical and empirical probabilities on the same axes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="n">ks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="n">theoretical</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">pk_ER</span><span class="p">(</span><span class="n">kmean</span><span class="p">),</span> <span class="n">ks</span><span class="p">))</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">nk</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="n">empirical</span> <span class="o">=</span> <span class="p">[(</span><span class="n">ds</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">/</span> <span class="n">N</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ds</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ks</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ks</span><span class="p">,</span> <span class="n">theoretical</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Theoretical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ks</span><span class="p">,</span> <span class="n">empirical</span><span class="p">,</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Empirical&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$k$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$p_k$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Degree distribution ($N = </span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">, </span><span class="se">\\</span><span class="s1">langle k </span><span class="se">\\</span><span class="s1">rangle = </span><span class="si">{</span><span class="n">kmean</span><span class="si">}</span><span class="s1">$)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/generating-cdfs_21_0.png" src="_images/generating-cdfs_21_0.png" />
</div>
</div>
<p>From the empirical computation of <span class="math notranslate nohighlight">\(p_k\)</span> it is easy to derive <span class="math notranslate nohighlight">\(P(k \geq v)\)</span> by summing -up the probabilities. Again, we define a function that, given a function that computes <span class="math notranslate nohighlight">\(p_k\)</span>, returns a function that computes <span class="math notranslate nohighlight">\(P(k \geq v)\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cdf_g</span><span class="p">(</span><span class="n">g</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Return the CDF of the given network.&#39;&#39;&#39;</span>
    
    <span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">nk</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
        <span class="n">gte</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;=</span> <span class="n">v</span><span class="p">:</span>
                <span class="n">gte</span> <span class="o">+=</span> <span class="n">ds</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">gte</span> <span class="o">/</span> <span class="n">g</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">cdf</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cdf_g</span><span class="p">(</span><span class="n">g</span><span class="p">)(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.2815
</pre></div>
</div>
</div>
</div>
<p>Let us now turn to the generating function approach. The degree distribution for an ER network is generated <a class="reference external" href="#NSW01">[NSW01]</a> by</p>
<div class="math notranslate nohighlight">
\[
G_0(x) = e^{\langle k \rangle (x - 1)}
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">G0_ER</span><span class="p">(</span><span class="n">kmean</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Return the degree generating function for an ER network with mean degree kmean.&#39;&#39;&#39;</span>
    
    <span class="k">def</span> <span class="nf">G0</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cmath</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">kmean</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>   <span class="c1"># note use of complex exponentiation</span>
    
    <span class="k">return</span> <span class="n">G0</span>
</pre></div>
</div>
</div>
</div>
<p>Given a degree generating function we can extract <span class="math notranslate nohighlight">\(p_k\)</span> by taking derivatives. If we know the generating function we can sometimes perform this symbolically, but a numerical solution would work for <em>any</em> generating function, notably for those built piecemeal from arbitrary distributions. The naive approach suffers from numerical instability, but <a class="reference external" href="#NSW01">[NSW01]</a> suggests a solution: differentiate the function using the Cauchy contour integral and the residue theorem:</p>
<div class="math notranslate nohighlight">
\[
f^{(n)}(a) = \frac{n!}{2\pi}\int_0^{2\pi} f(re^{i\theta} + a)r^{-n}e^{-i\theta n }d\theta
\]</div>
<p>where <span class="math notranslate nohighlight">\(r\)</span> is the radius of a small region around the point of interest.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">differentiate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Compute the n&#39;th derivative of f at a using a Cauchy contour integral of radius r.&#39;&#39;&#39;</span>
    
    <span class="c1"># make sure the function vectorises</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vectorize</span><span class="p">):</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        
    <span class="n">z</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span><span class="n">j</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dx</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span> <span class="o">/</span> <span class="n">z</span><span class="o">**</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can then use this to extract the individual degree probailities by differentiating the degree denerating function the appropriate number of times and evaluating the derivative at zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pk_gen</span><span class="p">(</span><span class="n">G0</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Return p_k from the degree generating function G0.&#39;&#39;&#39;</span>
    
    <span class="nd">@functools</span><span class="o">.</span><span class="n">lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">pk</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">differentiate</span><span class="p">(</span><span class="n">G0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">real</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">pk</span>
</pre></div>
</div>
</div>
</div>
<p>(Since degrees are always real, and indeed integer, it’s safe to extract only the real part of the computed derivative.) We can now see whether the degrees from the degree distribution align with those extracted from the generating function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="n">ks</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">pk_ER</span><span class="p">(</span><span class="n">kmean</span><span class="p">)</span>
<span class="n">G0</span> <span class="o">=</span> <span class="n">G0_ER</span><span class="p">(</span><span class="n">kmean</span><span class="p">)</span>
<span class="n">from_pk</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ks</span><span class="p">]</span>
<span class="n">from_G0</span> <span class="o">=</span> <span class="p">[</span><span class="n">differentiate</span><span class="p">(</span><span class="n">G0</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span><span class="o">.</span><span class="n">real</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ks</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ks</span><span class="p">,</span> <span class="n">from_pk</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;From $p_k$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ks</span><span class="p">,</span> <span class="n">from_G0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;From $G_0$&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$k$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$p_k$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Degree distribution ($N = </span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">, </span><span class="se">\\</span><span class="s1">langle k </span><span class="se">\\</span><span class="s1">rangle = </span><span class="si">{</span><span class="n">kmean</span><span class="si">}</span><span class="s1">$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/generating-cdfs_32_0.png" src="_images/generating-cdfs_32_0.png" />
</div>
</div>
<p>The CDF generating function can then be synthesised from the degree distribution generating function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cdf_gen</span><span class="p">(</span><span class="n">G0</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Return the CDF at v from the degree generating function G0.&#39;&#39;&#39;</span>
    
    <span class="nd">@functools</span><span class="o">.</span><span class="n">lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">G0_v</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="n">pk</span> <span class="o">=</span> <span class="n">pk_gen</span><span class="p">(</span><span class="n">G0</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">([</span><span class="n">pk</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">v</span><span class="p">)])</span>
        <span class="k">return</span> <span class="n">s</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">G0_v</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cdf_gen</span><span class="p">(</span><span class="n">G0_ER</span><span class="p">(</span><span class="n">kmean</span><span class="p">),</span> <span class="mi">10</span><span class="p">)(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.28337574127298937
</pre></div>
</div>
</div>
</div>
<p>To check the workings of the CDF generating function we can again plot the empirical and theoertical results side by side.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="n">ks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="n">theoretical</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="n">cdf_gen</span><span class="p">(</span><span class="n">G0_ER</span><span class="p">(</span><span class="n">kmean</span><span class="p">),</span> <span class="n">k</span><span class="p">)(</span><span class="mi">1</span><span class="p">),</span> <span class="n">ks</span><span class="p">))</span>
<span class="n">empirical</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">cdf_g</span><span class="p">(</span><span class="n">g</span><span class="p">),</span> <span class="n">ks</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ks</span><span class="p">,</span> <span class="n">theoretical</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Theoretical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ks</span><span class="p">,</span> <span class="n">empirical</span><span class="p">,</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Empirical&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$v$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$p_{k \geq v}$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cumulative degree distribution ($N = </span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">, </span><span class="se">\\</span><span class="s1">langle k </span><span class="se">\\</span><span class="s1">rangle = </span><span class="si">{</span><span class="n">kmean</span><span class="si">}</span><span class="s1">$)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/generating-cdfs_37_0.png" src="_images/generating-cdfs_37_0.png" />
</div>
</div>
<p>Our claim was that this technique can work with <em>any</em> generating function. To test this, let’s create a powerlaw-with-cutoff degree distribution and apply the same CDF process to its generating function, comparing with the empirical solution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N_PLC</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">1e5</span><span class="p">)</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">kappa</span> <span class="o">=</span> <span class="mi">50</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">params</span><span class="p">[</span><span class="n">epydemic</span><span class="o">.</span><span class="n">PLCNetwork</span><span class="o">.</span><span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="n">N_PLC</span>
<span class="n">params</span><span class="p">[</span><span class="n">epydemic</span><span class="o">.</span><span class="n">PLCNetwork</span><span class="o">.</span><span class="n">EXPONENT</span><span class="p">]</span> <span class="o">=</span> <span class="n">tau</span>
<span class="n">params</span><span class="p">[</span><span class="n">epydemic</span><span class="o">.</span><span class="n">PLCNetwork</span><span class="o">.</span><span class="n">CUTOFF</span><span class="p">]</span> <span class="o">=</span> <span class="n">kappa</span>

<span class="n">g_plc</span> <span class="o">=</span> <span class="n">epydemic</span><span class="o">.</span><span class="n">PLCNetwork</span><span class="p">(</span><span class="n">params</span><span class="p">)</span><span class="o">.</span><span class="n">generate</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The degree distribution is generated <a class="reference external" href="#NSW01">[NSW01]</a> by</p>
<div class="math notranslate nohighlight">
\[
G_0(x) = \frac{Li_\tau(x e^{-1 / \kappa})}{Li_\tau(e^{-1 / \kappa})}
\]</div>
<p>which again can be coded directly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">G0_PLC</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="n">kappa</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Return the degree generating function for a powerlaw-with-cutoff network with exponent tau and cutoff kappa.&#39;&#39;&#39;</span>
    
    <span class="nd">@functools</span><span class="o">.</span><span class="n">lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">G0</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">mpmath</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="n">x</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="n">kappa</span><span class="p">))</span> <span class="o">/</span> <span class="n">mpmath</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="n">kappa</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">G0</span>
</pre></div>
</div>
</div>
</div>
<p>Plotting theoretical and empirical results again, this time on a log-linear scale, gives:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="n">ks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">60</span><span class="p">))</span>
<span class="n">theoretical</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">k</span><span class="p">:</span> <span class="n">cdf_gen</span><span class="p">(</span><span class="n">G0_PLC</span><span class="p">(</span><span class="n">tau</span><span class="p">,</span> <span class="n">kappa</span><span class="p">),</span> <span class="n">k</span><span class="p">)(</span><span class="mi">1</span><span class="p">),</span> <span class="n">ks</span><span class="p">))</span>
<span class="n">empirical</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">cdf_g</span><span class="p">(</span><span class="n">g_plc</span><span class="p">),</span> <span class="n">ks</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ks</span><span class="p">,</span> <span class="n">theoretical</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Theoretical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ks</span><span class="p">[::</span><span class="mi">5</span><span class="p">],</span> <span class="n">empirical</span><span class="p">[::</span><span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;go&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Empirical&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$v$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$p_{k \geq v}$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cumulative degree distribution ($N = </span><span class="si">{</span><span class="n">N_PLC</span><span class="si">}</span><span class="s1">, </span><span class="se">\\</span><span class="s1">tau = </span><span class="si">{</span><span class="n">tau</span><span class="si">}</span><span class="s1">, </span><span class="se">\\</span><span class="s1">kappa = </span><span class="si">{</span><span class="n">kappa</span><span class="si">}</span><span class="s1">$)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/generating-cdfs_44_0.png" src="_images/generating-cdfs_44_0.png" />
</div>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p><a name="NSW01">[NSW01]</a> M.E.J. Newman, Steven Strogatz, and Duncan Watts. Random graphs with arbitrary degree distributions and their applications. Physical Review E <strong>64</strong>. 2001.</p>
<p><a name="generatingfunctionology">[Wil94]</a> Herbert Wilf. Generatingfunctionology. Academic Press. 1994.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="cauchy.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">High-degree numerical differentiation of generating functions</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="simulation.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Epidemic simulation</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Simon Dobson<br/>
    
        &copy; <a href="copyright.html">Copyright</a> 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>